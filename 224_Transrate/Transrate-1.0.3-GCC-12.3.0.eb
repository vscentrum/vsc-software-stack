# easyblock = 'Bundle'
easyblock = 'RubyGem'

name = 'Transrate'
version = '1.0.3'

homepage = 'https://hibberdlab.com/transrate'
description = """Transrate is software for de-novo transcriptome assembly quality analysis.
 It examines your assembly in detail and compares it to experimental evidence such as the sequencing reads,
 reporting quality scores for contigs and assemblies. This allows you to choose between assemblers and parameters,
 filter out the bad contigs from an assembly, and help decide when to stop trying to improve the assembly."""

toolchain = {'name': 'GCC', 'version': '12.3.0'}

source_urls = ['https://github.com/blahah/transrate/archive/']
sources = ['v%(version)s.tar.gz']

builddependencies = [
    ('binutils', '2.40'),
]

dependencies = [
    ('Ruby', '3.3.0'),
    ('crb-blast', '0.6.9'),
]

# preinstallopts = "echo here && pwd && ls -lh && "

# exts_default_options = {
#     'source_urls': ['https://rubygems.org/downloads/'],
#     'source_tmpl': '%(name)s-%(version)s.gem',
# }
#
# exts_defaultclass = 'RubyGem'
#
# exts_list = [
#     ('colorize', '0.7.7', {
#         'checksums': ['d6ab95a5fcdea3c36c3327d38c1e79e2950ee1788506d8489ae35db330937a99'],
#     }),
#     ('%(namelower)s', version, {
#         'source_urls': ['https://github.com/blahah/transrate/archive/'],
#         'sources': ['v%(version)s.tar.gz'],
#         'preinstallopts': "echo here && pwd && ls -lh && gem build transrate.gemspec && find -type f -name '*.gem' && ",
#         # 'gem_file': '%(namelower)s-%(version)s.gem',
#         'checksums': ['2ccb101cfab5a33586ea9e62af2b2f14caf6bc016724d1fef796b427e39fe100'],
#     }),
# ]

sanity_check_paths = {
    'files': ['bin/%(namelower)s'],
    'dirs': ['gems/%(namelower)s-%(version)s'],
}

# sanity_check_commands = ["%(namelower)s --help"]

# modextrapaths = {'GEM_PATH': ['']}

moduleclass = 'bio'

# TODO
# /kyukon/scratch/gent/vo/001/gvo00117/easybuild/RHEL8/cascadelake-ampere-ib/software/crb-blast/0.6.9-GCC-12.3.0/gems/yell-2.0.7/lib/yell/level.rb:181:in `calculate!': undefined method `tainted?' for an instance of Yell::Level (NoMethodError)
#
#       taint unless tainted?
#                    ^^^^^^^^
#         from /kyukon/scratch/gent/vo/001/gvo00117/easybuild/RHEL8/cascadelake-ampere-ib/software/crb-blast/0.6.9-GCC-12.3.0/gems/yell-2.0.7/lib/yell/level.rb:105:in `gte'
#         from /kyukon/scratch/gent/vo/001/gvo00117/easybuild/RHEL8/cascadelake-ampere-ib/software/crb-blast/0.6.9-GCC-12.3.0/gems/yell-2.0.7/lib/yell/level.rb:164:in `block in interpret'
#         from /kyukon/scratch/gent/vo/001/gvo00117/easybuild/RHEL8/cascadelake-ampere-ib/software/crb-blast/0.6.9-GCC-12.3.0/gems/yell-2.0.7/lib/yell/level.rb:162:in `each'
#         from /kyukon/scratch/gent/vo/001/gvo00117/easybuild/RHEL8/cascadelake-ampere-ib/software/crb-blast/0.6.9-GCC-12.3.0/gems/yell-2.0.7/lib/yell/level.rb:162:in `interpret'
#         from /kyukon/scratch/gent/vo/001/gvo00117/easybuild/RHEL8/cascadelake-ampere-ib/software/crb-blast/0.6.9-GCC-12.3.0/gems/yell-2.0.7/lib/yell/level.rb:57:in `set'
#         from /kyukon/scratch/gent/vo/001/gvo00117/easybuild/RHEL8/cascadelake-ampere-ib/software/crb-blast/0.6.9-GCC-12.3.0/gems/yell-2.0.7/lib/yell/level.rb:46:in `initialize'
#         from /kyukon/scratch/gent/vo/001/gvo00117/easybuild/RHEL8/cascadelake-ampere-ib/software/crb-blast/0.6.9-GCC-12.3.0/gems/yell-2.0.7/lib/yell/helpers/tracer.rb:36:in `new'
#         from /kyukon/scratch/gent/vo/001/gvo00117/easybuild/RHEL8/cascadelake-ampere-ib/software/crb-blast/0.6.9-GCC-12.3.0/gems/yell-2.0.7/lib/yell/helpers/tracer.rb:36:in `reset!'
#         from /kyukon/scratch/gent/vo/001/gvo00117/easybuild/RHEL8/cascadelake-ampere-ib/software/crb-blast/0.6.9-GCC-12.3.0/gems/yell-2.0.7/lib/yell/helpers/silencer.rb:21:in `reset!'
#         from /kyukon/scratch/gent/vo/001/gvo00117/easybuild/RHEL8/cascadelake-ampere-ib/software/crb-blast/0.6.9-GCC-12.3.0/gems/yell-2.0.7/lib/yell/logger.rb:51:in `initialize'
#         from /kyukon/scratch/gent/vo/001/gvo00117/easybuild/RHEL8/cascadelake-ampere-ib/software/crb-blast/0.6.9-GCC-12.3.0/gems/yell-2.0.7/lib/yell.rb:35:in `new'
#         from /kyukon/scratch/gent/vo/001/gvo00117/easybuild/RHEL8/cascadelake-ampere-ib/software/crb-blast/0.6.9-GCC-12.3.0/gems/yell-2.0.7/lib/yell.rb:35:in `new'
#         from /kyukon/scratch/gent/vo/001/gvo00117/easybuild/RHEL8/cascadelake-ampere-ib/software/Transrate/1.0.3-GCC-12.3.0/gems/transrate-1.0.3/lib/transrate.rb:19:in `<module:Transrate>'
#         from /kyukon/scratch/gent/vo/001/gvo00117/easybuild/RHEL8/cascadelake-ampere-ib/software/Transrate/1.0.3-GCC-12.3.0/gems/transrate-1.0.3/lib/transrate.rb:8:in `<top (required)>'
#         from <internal:/kyukon/scratch/gent/vo/001/gvo00117/easybuild/RHEL8/cascadelake-ampere-ib/software/Ruby/3.3.0-GCCcore-12.3.0/lib/ruby/3.3.0/rubygems/core_ext/kernel_require.rb>:127:in `require'
#         from <internal:/kyukon/scratch/gent/vo/001/gvo00117/easybuild/RHEL8/cascadelake-ampere-ib/software/Ruby/3.3.0-GCCcore-12.3.0/lib/ruby/3.3.0/rubygems/core_ext/kernel_require.rb>:127:in `require'
#         from /kyukon/scratch/gent/vo/001/gvo00117/easybuild/RHEL8/cascadelake-ampere-ib/software/Transrate/1.0.3-GCC-12.3.0/gems/transrate-1.0.3/bin/transrate:2:in `<top (required)>'
#         from /scratch/gent/vo/001/gvo00117/easybuild/RHEL8/cascadelake-ampere-ib/software/Transrate/1.0.3-GCC-12.3.0/bin/transrate:25:in `load'
#         from /scratch/gent/vo/001/gvo00117/easybuild/RHEL8/cascadelake-ampere-ib/software/Transrate/1.0.3-GCC-12.3.0/bin/transrate:25:in `<main>'
