easyblock = 'EB_Amber'

name = 'AmberTools'
local_ambertools_ver = 22
# Patch levels from http://ambermd.org/AmberPatches.php and http://ambermd.org/ATPatches.php
patchlevels = (3, 0)  # (AmberTools, Amber)
version = '%s.%s' % (local_ambertools_ver, patchlevels[0])

homepage = 'https://ambermd.org/'
description = """AmberTools consists of several independently developed packages that work well by themselves,
 and with Amber itself. The suite can also be used to carry out complete molecular dynamics simulations,
 with either explicit water or generalized Born solvent models."""

toolchain = {'name': 'foss', 'version': '2023a'}
toolchainopts = {'usempi': True}

# download requires registration
local_download_credentials = '?Name=Easybuild&Institution=Easybuild&City=Internet&State=Other&Country=Belgium'
source_urls = ['https://ambermd.org/cgi-bin/AmberTools%s-get.pl' % local_ambertools_ver]
sources = [{
    'download_filename': local_download_credentials,
    'filename': 'AmberTools%s.tar.bz2' % local_ambertools_ver,
}]
patches = [
    'AmberTools-20_cmake-locate-netcdf.patch',
    'AmberTools-20_fix_missing_MPI_LIBRARY_error.patch',
    'AmberTools-20_fix_xblas_missing_make_dependency.patch',
    'AmberTools-21_CMake-FlexiBLAS.patch',
    'AmberTools-21_fix_DGESVD_workspace_query.patch',
    'AmberTools-21_fix_incorrect_dvout_call.patch',
    'AmberTools-21_fix_incorrect_mexit_calls.patch',
    'AmberTools-21_fix_more_blas_argument_problems.patch',
    'AmberTools-21_fix_multiple_definition.patch',
    'AmberTools-21_fix_potential_use_before_init.patch',
    'AmberTools-21_fix_rism_argument_mismatch.patch',
    'AmberTools-21_fix_xray_fftpack_arg_mismatch.patch',
    'AmberTools-22_fix_test_missing_cuda_dir.patch',
    'AmberTools-22_fix_missing_error_check_on_test_run.patch',
]
checksums = [
    '1571d4e0f7d45b2a71dce5999fa875aea8c90ee219eb218d7916bf30ea229121',  # AmberTools22.tar.bz2
    '473e07c53b6f641d96d333974a6af2e03413fecef79f879d3fdecf7fecaab4d0',  # AmberTools-20_cmake-locate-netcdf.patch
    # AmberTools-20_fix_missing_MPI_LIBRARY_error.patch
    '0b89a0624167bc23876bcdefcb1055f591e38e3bd559a71d5749e342bd311acc',
    # AmberTools-20_fix_xblas_missing_make_dependency.patch
    'ff25e91fdc72347a778c3837b581e174d6a8c71efa5b46e11391b18bca84fd65',
    '9543812c24c4b7842f64f1f8abaf2c92b5c4c0fadcdbd9811e76b81a778f0d36',  # AmberTools-21_CMake-FlexiBLAS.patch
    # AmberTools-21_fix_DGESVD_workspace_query.patch
    '560c73e9d8bd159c609098c63a0256cdee78f49e524d06ea94d16d3146f69bcd',
    '1054d4007f5c79126a41582e1e80514267cf406416ed6c471574cd708b16319b',  # AmberTools-21_fix_incorrect_dvout_call.patch
    'd1de8c596119dcedbb809515816f0c98762306c469e9caf2c0b878d9b0a1095f',  # AmberTools-21_fix_incorrect_mexit_calls.patch
    # AmberTools-21_fix_more_blas_argument_problems.patch
    'c6279b57752239184b942d37f760749494ae0eff95236f3368c76ac0d2726a7c',
    'ce30eeaba9feea53aa115e4b0dcc5be943b8a55abe322480c807ca7ea963d83b',  # AmberTools-21_fix_multiple_definition.patch
    # AmberTools-21_fix_potential_use_before_init.patch
    '377e645b5bd2c91ebb4d0b6fbca0407a94289e5ddc5b1e7ed0cb0b0724ad2139',
    # AmberTools-21_fix_rism_argument_mismatch.patch
    '14255e5739cec39303df570f06820c7532f7395e1b73b1e4104377984e2c9fc1',
    # AmberTools-21_fix_xray_fftpack_arg_mismatch.patch
    '99c954e693659efc2a1d121f91510f56408006f0751d91595f45a34b03364e2f',
    'fb1ab74314d7816169bb9f3f527b78085654aae2825c52cebf50a5760401b737',  # AmberTools-22_fix_test_missing_cuda_dir.patch
    # AmberTools-22_fix_missing_error_check_on_test_run.patch
    'a86eee60bd65c16a849469e303cb99dfc207cbadd2ae9e70b9ff580ced785475',
]

builddependencies = [
    ('CMake', '3.26.3'),
    ('pkgconf', '1.9.5'),
    ('Bison', '3.8.2'),
    ('flex', '2.6.4'),
    ('make', '4.4.1'),
]

dependencies = [
    ('zlib', '1.2.13'),
    ('bzip2', '1.0.8'),
    ('Python', '3.11.3'),
    ('SciPy-bundle', '2023.07'),
    ('Perl', '5.36.1'),
    ('Perl-bundle-CPAN', '5.36.1'),
    ('Boost', '1.82.0'),
    ('libreadline', '8.2'),
    ('matplotlib', '3.7.2'),
    ('netCDF', '4.9.2'),
    ('netCDF-Fortran', '4.6.1'),
    ('PnetCDF', '1.12.3'),
    ('Tkinter', '%(pyver)s'),
    ('X11', '20230603'),
    ('mpi4py', '3.1.4'),
]

# prebuildopts = 'echo AAABBB && pwd && cd %(builddir)s && pwd &&'
# builddir = /tmp/vsc47063/easybuild/build/AmberTools/22.3/foss-2023a
# prebuildopts = 'rm %(builddir)s/AmberTools/src/pytraj/pytraj/math/cpp_math.cpp && cythonize -i %(builddir)s/AmberTools/src/pytraj/pytraj/math/cpp_math.pyx && '
prebuildopts = 'rm %(builddir)s/AmberTools/src/pytraj/pytraj/math/cpp_math.cpp && cython -3 -f --cplus --verbose %(builddir)s/AmberTools/src/pytraj/pytraj/math/cpp_math.pyx && '
# from TF_COMB: local_tfcomb_preinstallopts += "cd  tfcomb && rm counting.c && cythonize -i counting.pyx && cd .. && "
runtest = True

moduleclass = 'chem'

# ERROR4: 
    # [ 56%] Building Fortran object AmberTools/src/sebomd/CMakeFiles/sebomd.dir/se_diagp.F.o
    # cd /tmp/vsc47063/easybuild/build/AmberTools/22.3/foss-2023a/easybuild_obj/AmberTools/src/sander && /scratch
    # /gent/vo/001/gvo00117/easybuild/RHEL8/cascadelake-ampere-ib/software/OpenMPI/4.1.5-GCC-12.3.0/bin/mpifort -
    # DBINTRAJ -DEMIL -DMPI -DRISMSANDER -DUSE_MKSTEMP -D_GNU_SOURCE -I/tmp/vsc47063/easybuild/build/AmberTools/2
    # 2.3/foss-2023a/easybuild_obj/amber-modules/sander/mpi -I/tmp/vsc47063/easybuild/build/AmberTools/22.3/foss-
    # 2023a/easybuild_obj/amber-modules/sqm/lib/mpi -I/tmp/vsc47063/easybuild/build/AmberTools/22.3/foss-2023a/ea
    # sybuild_obj/amber-modules/rism/sander_interface/mpi -I/tmp/vsc47063/easybuild/build/AmberTools/22.3/foss-20
    # 23a/easybuild_obj/amber-modules/rism/lib/mpi -I/tmp/vsc47063/easybuild/build/AmberTools/22.3/foss-2023a/eas
    # ybuild_obj/amber-modules/pbsa/lib/mpi -I/tmp/vsc47063/easybuild/build/AmberTools/22.3/foss-2023a/easybuild_
    # obj/amber-modules/amberlib -I/apps/gent/RHEL8/cascadelake-ib/software/netCDF-Fortran/4.6.1-gompi-2023a/incl
    # ude -I/apps/gent/RHEL8/cascadelake-ib/software/Boost/1.82.0-GCC-12.3.0/include -O2 -ftree-vectorize -march=
    # native -fno-math-errno -Wall -Wno-tabs -Wno-unused-function -ffree-line-length-none -Wno-unused-dummy-argum
    # ent -Wno-unused-variable -fallow-argument-mismatch -fno-inline-arg-packing -J../../../amber-modules/sander/
    # mpi -O3 -mtune=native -c /tmp/vsc47063/easybuild/build/AmberTools/22.3/foss-2023a/AmberTools/src/sander/ew_
    # bspline.F90 -o CMakeFiles/sander_base_obj_mpi.dir/ew_bspline.F90.o
    # cd /tmp/vsc47063/easybuild/build/AmberTools/22.3/foss-2023a/easybuild_obj/AmberTools/src/sebomd && /scratch
    # /gent/vo/001/gvo00117/easybuild/RHEL8/cascadelake-ampere-ib/software/OpenMPI/4.1.5-GCC-12.3.0/bin/mpifort -
    # DBINTRAJ -DRISMSANDER -DUSE_MKSTEMP -D_GNU_SOURCE -I/tmp/vsc47063/easybuild/build/AmberTools/22.3/foss-2023
    # a/easybuild_obj/amber-modules/sebomd -I/tmp/vsc47063/easybuild/build/AmberTools/22.3/foss-2023a/easybuild_o
    # bj/amber-modules/sander -I/tmp/vsc47063/easybuild/build/AmberTools/22.3/foss-2023a/easybuild_obj/amber-modu
    # les/amberlib -I/apps/gent/RHEL8/cascadelake-ib/software/netCDF-Fortran/4.6.1-gompi-2023a/include -I/apps/ge
    # nt/RHEL8/cascadelake-ib/software/netCDF/4.9.2-gompi-2023a/include -O2 -ftree-vectorize -march=native -fno-m
    # ath-errno -Wall -Wno-tabs -Wno-unused-function -ffree-line-length-none -Wno-unused-dummy-argument -Wno-unus
    # ed-variable -fallow-argument-mismatch -fno-inline-arg-packing -J../../../amber-modules/sebomd -fPIC -O3 -mt
    # une=native -c /tmp/vsc47063/easybuild/build/AmberTools/22.3/foss-2023a/AmberTools/src/sebomd/se_diagp.F -o 
    # CMakeFiles/sebomd.dir/se_diagp.F.o
    #   212 |   #include "longintrepr.h"
    #       |            ^~~~~~~~~~~~~~~
    # compilation terminated.
    # error: command '/scratch/gent/vo/001/gvo00117/easybuild/RHEL8/cascadelake-ampere-ib/software/OpenMPI/4.1.5-GCC-12.3.0/bin/mpicc' failed with exit code 1
# ERROR3:
    # -> try to add â€“cplus flag to cython cmd -> seems work but E4 occured
    # after change from cynthonize to cython -3 -f --verbose  /cpp_math.pyx
    # == 2024-06-17 14:40:18,043 build_log.py:171 ERROR EasyBuild crashed with an error (at easybuild/easybuild-framework/easybuild/base/exceptions.py:126 in __init__): 
    #     cmd "rm /tmp/vsc47063/easybuild/build/AmberTools/22.3/foss-2023a/AmberTools/src/pytraj/pytraj/math/cpp_math.cpp && 
    #     cython -3 -f --verbose /tmp/vsc47063/easybuild/build/AmberTools/22.3/foss-2023a/AmberTools/src/pytraj/pytraj/math/cpp_math.pyx &&  make  -j 8 " exited
    # with exit code 1 and output:
    #     Compiling /tmp/vsc47063/easybuild/build/AmberTools/22.3/foss-2023a/AmberTools/src/pytraj/pytraj/math/cpp_ma
    #     th.pyx
    #     warning: /apps/gent/RHEL8/cascadelake-ib/software/Python-bundle-PyPI/2023.06-GCCcore-12.3.0/lib/python3.11/
    #     site-packages/Cython/Includes/libcpp/string.pxd:194:20: Function signature does not match previous declaration
    # ...
    # Error compiling Cython file:
    #     ------------------------------------------------------------
    #     ...
    #         def __repr__(self):
    #             return self.__str__()

    #         def copy(self):
    #             cdef Vec3 vec = Vec3()
    #             vec.thisptr = new _Vec3(self.thisptr[0])
    #                                              ^
    #     ------------------------------------------------------------

    #     :26: Operation only allowed in c++
# ERROR2:
    # after cythonize in ERROR1:
    # == 2024-06-17 14:05:54,845 build_log.py:171 ERROR EasyBuild crashed with an error (at easybuild/easybuild-framework/easybuild/base/exceptions.py:126 in __init__): 
    #     cmd "rm /tmp/vsc47063/easybuild/build/AmberTools/22.3/foss-2023a/AmberTools/src/pytraj/pytraj/math/cpp_math.cpp 
    #     && cythonize -i /tmp/vsc47063/easybuild/build/AmberTools/22.3/foss-2023a/AmberTools/src/pytraj/pytraj/math/cpp_math.pyx &&  make  -j 8 " exited with exit
    #     code 1 and output:
    #     /apps/gent/RHEL8/cascadelake-ib/software/Python-bundle-PyPI/2023.06-GCCcore-12.3.0/lib/python3.11/site-pack
    #     ages/Cython/Compiler/Main.py:369: FutureWarning: Cython directive 'language_level' not set, using 2 for now
    #     (Py2). This will change in a later release! File: /tmp/vsc47063/easybuild/build/AmberTools/22.3/foss-2023a
    #     /AmberTools/src/pytraj/pytraj/math/cpp_math.pxd
    #     tree = Parsing.p_module(s, pxd, full_module_name)
    #     Compiling /tmp/vsc47063/easybuild/build/AmberTools/22.3/foss-2023a/AmberTools/src/pytraj/pytraj/math/cpp_ma
    #     th.pyx because it changed.
    #     [1/1] Cythonizing /tmp/vsc47063/easybuild/build/AmberTools/22.3/foss-2023a/AmberTools/src/pytraj/pytraj/mat
    #     h/cpp_math.pyx
    #     /apps/gent/RHEL8/cascadelake-ib/software/Python/3.11.3-GCCcore-12.3.0/lib/python3.11/site-packages/setuptoo
    #     ls/dist.py:755: SetuptoolsDeprecationWarning: Invalid dash-separated options
    #     MPI family 'OpenMPI'
    #     == 2024-06-17 14:05:41,893 mpi.py:307 INFO Using MPI command template 'mpirun -n %(nr_ranks)s %(cmd)s' (par
    #     ams: {'nr_ranks': 1, 'cmd': 'xxx_command_xxx'})
    #     == 2024-06-17 14:05:41,893 easyconfig.py:1721 INFO Template values: arch='x86_64', bitbucket_account='amber
    #     tools', builddir='/tmp/vsc47063/easybuild/build/AmberTools/22.3/foss-2023a', cuda_cc_cmake='86', cuda_cc_se
    #     micolon_sep='8.6', cuda_cc_space_sep='8.6', cuda_compute_capabilities='8.6', cuda_sm_comma_sep='sm_86', cud
    #     a_sm_space_sep='sm_86', github_account='ambertools', installdir='/scratch/gent/vo/001/gvo00117/easybuild/RH
    #     EL8/cascadelake-ampere-ib/software/AmberTools/22.3-foss-2023a', module_name='AmberTools/22.3-foss-2023a', m
    #     pi_cmd_prefix='mpirun -n 1', name='AmberTools', nameletter='A', nameletterlower='a', namelower='ambertools'
    #     , parallel='8', perlmajver='5', perlminver='36', perlshortver='5.36', perlver='5.36.1', pymajver='3', pymin
    #     ver='11', pyshortver='3.11', pyver='3.11.3', start_dir='/tmp/vsc47063/easybuild/build/AmberTools/22.3/foss-
    #     2023a/', sysroot='', toolchain_name='foss', toolchain_version='2023a', version='22.3', version_major='22', 
    #     version_major_minor='22.3', version_minor='3', versionprefix='', versionsuffix=''
    #     == 2024-06-17 14:05:41,893 easyblock.py:3958 INFO Running method build_step part of step build
    #     == 2024-06-17 14:05:41,893 configuremake.py:352 INFO Building target ''
    #     == 2024-06-17 14:05:41,893 run.py:247 INFO running cmd: rm /tmp/vsc47063/easybuild/build/AmberTools/22.3/fo
    #     ss-2023a/AmberTools/src/pytraj/pytraj/math/cpp_math.cpp && cythonize -i /tmp/vsc47063/easybuild/build/Amber
    #     Tools/22.3/foss-2023a/AmberTools/src/pytraj/pytraj/math/cpp_math.pyx &&  make  -j 8  
    #     == 2024-06-17 14:05:54,845 build_log.py:171 ERROR EasyBuild crashed with an error (at easybuild/easybuild-f
    #     ramework/easybuild/base/exceptions.py:126 in __init__): cmd "rm /tmp/vsc47063/easybuild/build/AmberTools/22
    #     .3/foss-2023a/AmberTools/src/pytraj/pytraj/math/cpp_math.cpp && cythonize -i /tmp/vsc47063/easybuild/build/
    #     AmberTools/22.3/foss-2023a/AmberTools/src/pytraj/pytraj/math/cpp_math.pyx &&  make  -j 8 " exited with exit
    #     code 1 and output:
    #     /apps/gent/RHEL8/cascadelake-ib/software/Python-bundle-PyPI/2023.06-GCCcore-12.3.0/lib/python3.11/site-pack
    #     ages/Cython/Compiler/Main.py:369: FutureWarning: Cython directive 'language_level' not set, using 2 for now
    #     (Py2). This will change in a later release! File: /tmp/vsc47063/easybuild/build/AmberTools/22.3/foss-2023a
    #     /AmberTools/src/pytraj/pytraj/math/cpp_math.pxd
    #     tree = Parsing.p_module(s, pxd, full_module_name)
    #     Compiling /tmp/vsc47063/easybuild/build/AmberTools/22.3/foss-2023a/AmberTools/src/pytraj/pytraj/math/cpp_ma
    #     th.pyx because it changed.
    #     [1/1] Cythonizing /tmp/vsc47063/easybuild/build/AmberTools/22.3/foss-2023a/AmberTools/src/pytraj/pytraj/mat
    #     h/cpp_math.pyx
    #     /apps/gent/RHEL8/cascadelake-ib/software/Python/3.11.3-GCCcore-12.3.0/lib/python3.11/site-packages/setuptoo
    #     ls/dist.py:755: SetuptoolsDeprecationWarning: Invalid dash-separated options
    #     !!

    #             ********************************************************************************
    #             Usage of dash-separated 'description-file' will not be supported in future
    #             versions. Please use the underscore name 'description_file' instead.

    #             This deprecation is overdue, please update your project and remove deprecated
    #             calls to avoid build errors in the future.

    #             See https://setuptools.pypa.io/en/latest/userguide/declarative_config.html for details.
    #             ********************************************************************************

    #     !!
    #     opt = self.warn_dash_deprecation(opt, section)
    #     running build_ext
    #     building 'pytraj.math.cpp_math' extension
    #     47063/easybuild/build/AmberTools/22.3/foss-2023a/AmberTools/src/pytraj/pytraj/math
    #     hon3.11 -c'
    #     _math.cpp
    #     :10: fatal error: Grid.h: No such file or directory
    #     781 | #include "Grid.h"
    #         |          ^~~~~~~~
    #     compilation terminated.
    #     exit status 1
# ERROR1:
    # in cmake step:
        # == 2024-06-17 11:02:01,560 run.py:701 WARNING Found 4 potential errors (some may be harmless) in output of  cmake  -DCMAKE_INSTALL_PREFIX=/scratch/gent/vo/001/gvo00117/easybuild/RHEL8/cascadelake-ampere-ib/software/AmberTools/22.3-foss-2023a -DCMAKE_BUILD_TYPE=Release -DCMAKE_POLICY_DEFAULT_CMP0094=NEW -DCMAKE_VERBOSE_MAKEFILE=ON -DCMAKE_FIND_USE_PACKAGE_REGISTRY=OFF -DBOOST_ROOT=/apps/gent/RHEL8/cascadelake-ib/software/Boost/1.82.0-GCC-12.3.0 -DBoost_NO_SYSTEM_PATHS=ON  -DMPI=TRUE  -DBLA_VENDOR=FlexiBLAS  -DDOWNLOAD_MINICONDA=FALSE  -DPYTHON_EXECUTABLE=/apps/gent/RHEL8/cascadelake-ib/software/Python/3.11.3-GCCcore-12.3.0/bin/python  -DFORCE_EXTERNAL_LIBS='fftw;netcdf;netcdf-fortran;zlib;boost;pnetcdf'  -DUSE_FFT=TRUE  -DCHECK_UPDATES=FALSE  -DAPPLY_UPDATES=FALSE  -DTRUST_SYSTEM_LIBS=TRUE  -DCOLOR_CMAKE_MESSAGES=FALSE  -DINSTALL_TESTS=FALSE  -DCOMPILER=AUTO  /tmp/vsc47063/easybuild/build/AmberTools/22.3/foss-2023a/:
        #     -- Performing Test CMAKE_HAVE_LIBC_PTHREAD - Failed
        #     -- Performing Test CMath_LINKS_WITHOUT_M - Failed
        #     -- Checking for perl module Chemistry::Mol - failed
        #     -- Failed to find Perl modules: Chemistry::Mol (missing: PERLMODULES_CHEMISTRY_MOL_MODULE)
    # in make step 2:
        # -> delete /tmp/vsc47063/easybuild/build/AmberTools/22.3/foss-2023a/AmberTools/src/pytraj/pytraj/math/cpp_math.cpp 
            #   + cythonize - let cython create new one from cpp_math.pyx
        # [ 58%] Building Fortran object AmberTools/src/sander/CMakeFiles/sander_base_obj_mpi.dir/qmmm_adaptive_module.F90.o
        #     cd /tmp/vsc47063/easybuild/build/AmberTools/22.3/foss-2023a/easybuild_obj/AmberTools/src/sander && /scratch
        #     /gent/vo/001/gvo00117/easybuild/RHEL8/cascadelake-ampere-ib/software/OpenMPI/4.1.5-GCC-12.3.0/bin/mpifort -
        #     DBINTRAJ -DEMIL -DMPI -DRISMSANDER -DUSE_MKSTEMP -D_GNU_SOURCE -I/tmp/vsc47063/easybuild/build/AmberTools/2
        #     2.3/foss-2023a/easybuild_obj/amber-modules/sander/mpi -I/tmp/vsc47063/easybuild/build/AmberTools/22.3/foss-
        #     2023a/easybuild_obj/amber-modules/sqm/lib/mpi -I/tmp/vsc47063/easybuild/build/AmberTools/22.3/foss-2023a/ea
        #     sybuild_obj/amber-modules/rism/sander_interface/mpi -I/tmp/vsc47063/easybuild/build/AmberTools/22.3/foss-20
        #     23a/easybuild_obj/amber-modules/rism/lib/mpi -I/tmp/vsc47063/easybuild/build/AmberTools/22.3/foss-2023a/eas
        #     ybuild_obj/amber-modules/pbsa/lib/mpi -I/tmp/vsc47063/easybuild/build/AmberTools/22.3/foss-2023a/easybuild_
        #     obj/amber-modules/amberlib -I/apps/gent/RHEL8/cascadelake-ib/software/netCDF-Fortran/4.6.1-gompi-2023a/incl
        #     ude -I/apps/gent/RHEL8/cascadelake-ib/software/Boost/1.82.0-GCC-12.3.0/include -O2 -ftree-vectorize -march=
        #     native -fno-math-errno -Wall -Wno-tabs -Wno-unused-function -ffree-line-length-none -Wno-unused-dummy-argum
        #     ent -Wno-unused-variable -fallow-argument-mismatch -fno-inline-arg-packing -J../../../amber-modules/sander/
        #     mpi -O0 -c /tmp/vsc47063/easybuild/build/AmberTools/22.3/foss-2023a/AmberTools/src/sander/qmmm_adaptive_mod
        #     ule.F90 -o CMakeFiles/sander_base_obj_mpi.dir/qmmm_adaptive_module.F90.o
        #     /tmp/vsc47063/easybuild/build/AmberTools/22.3/foss-2023a/AmberTools/src/sebomd/se_grepul.F:111:27:

        #     111 |       double precision qzzq,   diffqzzq
        #         |                           ^
        #     Warning: qzzq may be used uninitialized [-Wmaybe-uninitialized]
        #     /tmp/vsc47063/easybuild/build/AmberTools/22.3/foss-2023a/AmberTools/src/sebomd/se_grepul.F:108:27:

        #     108 |       double precision qxxq,   diffqxxq
        #         |                           ^
        #     Warning: qxxq may be used uninitialized [-Wmaybe-uninitialized]
        #     /tmp/vsc47063/easybuild/build/AmberTools/22.3/foss-2023a/AmberTools/src/sebomd/se_grepul.F:111:39:

        #     111 |       double precision qzzq,   diffqzzq
        #         |                                       ^
        #     Warning: diffqzzq may be used uninitialized [-Wmaybe-uninitialized]
        #     /tmp/vsc47063/easybuild/build/AmberTools/22.3/foss-2023a/AmberTools/src/sebomd/se_grepul.F:108:39:

        #     108 |       double precision qxxq,   diffqxxq
        #         |                                       ^
        #     Warning: diffqxxq may be used uninitialized [-Wmaybe-uninitialized]
        #     /tmp/vsc47063/easybuild/build/AmberTools/22.3/foss-2023a/AmberTools/src/sebomd/se_grepul.F:110:27:

        #     110 |       double precision qqzz,   diffqqzz
        #         |                           ^
        #     Warning: qqzz may be used uninitialized [-Wmaybe-uninitialized]
        #     /tmp/vsc47063/easybuild/build/AmberTools/22.3/foss-2023a/AmberTools/src/sebomd/se_grepul.F:109:27:

        #     109 |       double precision qqxx,   diffqqxx
        #         |                           ^
        #     Warning: qqxx may be used uninitialized [-Wmaybe-uninitialized]
        #     /tmp/vsc47063/easybuild/build/AmberTools/22.3/foss-2023a/AmberTools/src/sebomd/se_grepul.F:110:39:

        #     110 |       double precision qqzz,   diffqqzz
        #         |                                       ^
        #     Warning: diffqqzz may be used uninitialized [-Wmaybe-uninitialized]
        #     /tmp/vsc47063/easybuild/build/AmberTools/22.3/foss-2023a/AmberTools/src/sebomd/se_grepul.F:109:39:

        #     109 |       double precision qqxx,   diffqqxx
        #         |                                       ^
        #     Warning: diffqqxx may be used uninitialized [-Wmaybe-uninitialized]
        #     /tmp/vsc47063/easybuild/build/AmberTools/22.3/foss-2023a/AmberTools/src/sebomd/se_grepul.F:306:72:

        #     306 |           qdz = -dzq
        #         |                                                                        ^
        #     Warning: dzq may be used uninitialized [-Wmaybe-uninitialized]
        #     /tmp/vsc47063/easybuild/build/AmberTools/22.3/foss-2023a/AmberTools/src/sebomd/se_grepul.F:130:26:

        #     130 |       double precision dzq, diffdzq
        #         |                          ^
        #     note: dzq was declared here
        #     /tmp/vsc47063/easybuild/build/AmberTools/22.3/foss-2023a/AmberTools/src/sebomd/se_grepul.F:307:72:

        #     307 |           diffqdz = -diffdzq
        #         |                                                                        ^
        #     Warning: diffdzq may be used uninitialized [-Wmaybe-uninitialized]
        #     /tmp/vsc47063/easybuild/build/AmberTools/22.3/foss-2023a/AmberTools/src/sebomd/se_grepul.F:130:35:

        #     130 |       double precision dzq, diffdzq
        #         |                                   ^
        #     note: diffdzq was declared here
        # pytraj/math/cpp_math.cpp:212:12: fatal error: longintrepr.h: No such file or directory
        #     212 |   #include "longintrepr.h"
        #         |            ^~~~~~~~~~~~~~~
        #     compilation terminated.
        #     error: command '/scratch/gent/vo/001/gvo00117/easybuild/RHEL8/cascadelake-ampere-ib/software/OpenMPI/4.1.5-
        #     GCC-12.3.0/bin/mpicc' failed with exit code 1
        # ...
        # [ 74%] Building CXX object AmberTools/src/cpptraj/src/CMakeFiles/cpptraj_common_obj_mpi.dir/Cluster/Silhouette.cpp.o
        #     cd /tmp/vsc47063/easybuild/build/AmberTools/22.3/foss-2023a/easybuild_obj/AmberTools/src/cpptraj/src && /scratch/gent/vo/001/gvo00117/easybuild/RHEL8/cascadelake-ampere-ib/software/OpenMPI/4.1.5-GCC-12.3.0/bin/mpicxx -DBINTRAJ -DBUILDTYPE=\"AmberTools\" -DC11_SUPPORT -DFFTW_FFT -DHASBZ2 -DHASGZ -DHAS_PNETCDF -DHAS_TNGFILE -DHAVE_FFTWD=1 -DLIBPME -DMPI -DUSE_MKSTEMP -D_GNU_SOURCE -Dlibcpptraj_EXPORTS -I/tmp/vsc47063/easybuild/build/AmberTools/22.3/foss-2023a/AmberTools/src/include -I/tmp/vsc47063/easybuild/build/AmberTools/22.3/foss-2023a/AmberTools/src/cpptraj/src/xdrfile/. -I/apps/gent/RHEL8/cascadelake-ib/software/netCDF/4.9.2-gompi-2023a/include -I/apps/gent/RHEL8/cascadelake-ib/software/bzip2/1.0.8-GCCcore-12.3.0/include -I/apps/gent/RHEL8/cascadelake-ib/software/zlib/1.2.13-GCCcore-12.3.0/include -I/scratch/gent/vo/001/gvo00117/easybuild/RHEL8/cascadelake-ampere-ib/software/FFTW.MPI/3.3.10-gompi-2023a/include -I/tmp/vsc47063/easybuild/build/AmberTools/22.3/foss-2023a/AmberTools/src/cpptraj/src/tng/. -I/scratch/gent/vo/001/gvo00117/easybuild/RHEL8/cascadelake-ampere-ib/software/PnetCDF/1.12.3-gompi-2023a/include -O2 -ftree-vectorize -march=native -fno-math-errno -Wall -Wno-unused-function -Wno-unknown-pragmas -Wno-unused-local-typedefs -Wno-unused-variable -Wno-unused-but-set-variable -std=gnu++11 -fPIC -MD -MT AmberTools/src/cpptraj/src/CMakeFiles/cpptraj_common_obj_mpi.dir/Cluster/Silhouette.cpp.o -MF CMakeFiles/cpptraj_common_obj_mpi.dir/Cluster/Silhouette.cpp.o.d -o CMakeFiles/cpptraj_common_obj_mpi.dir/Cluster/Silhouette.cpp.o -c /tmp/vsc47063/easybuild/build/AmberTools/22.3/foss-2023a/AmberTools/src/cpptraj/src/Cluster/Silhouette.cpp
        #     make[2]: Leaving directory '/tmp/vsc47063/easybuild/build/AmberTools/22.3/foss-2023a/easybuild_obj'
        #     [ 74%] Built target cpptraj_common_obj_mpi
        #     make[1]: Leaving directory '/tmp/vsc47063/easybuild/build/AmberTools/22.3/foss-2023a/easybuild_obj'
        #     make: *** [Makefile:159: all] Error 2
    # some errors after cmake?:
        # -- Checking for Python package mpi4py -- not found -> added mpi4py to deps
        # -- Checking for perl module Chemistry::Mol
        # -- Checking for perl module Chemistry::Mol - failed
        # -- Checking for perl module ExtUtils::MakeMaker
        # -- Checking for perl module ExtUtils::MakeMaker - found at /apps/gent/RHEL8/cascadelake-ib/software/Perl/5.36.1-GCCcore-12.3.0/lib/perl5/5.36.1/ExtUtils/MakeMaker.pm
        # -- Failed to find Perl modules: Chemistry::Mol (missing: PERLMODULES_CHEMISTRY_MOL_MODULE)
        # -- Could NOT find MBX (missing: MBX_DIR)
        # -- Could not find MBX.  To locate it, add its install dir to the prefix path.
        # -- Could NOT find tng_io (missing: tng_io_DIR)
        # -- Could not find tng_io.  To locate it, add its install dir to the prefix path.
        # -- Cannot find PLUMED.  You will still be able to load it at runtime.  If you want to link it at build time, set PLUMED_ROOT to where you instled it.
        # -- Performing Test CMAKE_HAVE_LIBC_PTHREAD - Failed
        # -- Performing Test CMath_LINKS_WITHOUT_M - Failed
        # -- Checking for perl module Chemistry::Mol - failed
        # -- Failed to find Perl modules: Chemistry::Mol (missing: PERLMODULES_CHEMISTRY_MOL_MODULE)
        # Warning: Fortran 2018 deleted feature: DO termination statement which is not END DO or CONTINUE with label 860 at (1)
            # /apps/gent/RHEL8/cascadelake-ib/software/binutils/2.40-GCCcore-12.3.0/bin/ld: cannot find -lvt-mpi: No such file or directory
            # collect2: error: ld returned 1 exit status
            # failure.
            # removing: _configtest.c _configtest.o
        # /apps/gent/RHEL8/cascadelake-ib/software/binutils/2.40-GCCcore-12.3.0/bin/ld: cannot find -lvt.mpi: No such file or directory
            # echo "DOT(z, z, d, _x)" | cat dot.m4 - | \
            #     /apps/gent/RHEL8/cascadelake-ib/software/M4/1.4.19-GCCcore-12.3.0/bin/m4 -D no_plain_blas -D no_f2c -I. -I.. - > tmp.BLAS_zdot_z_d_x.c && \
            #     :  tmp.BLAS_zdot_z_d_x.c && \
            #     mv tmp.BLAS_zdot_z_d_x.c ../../src/dot/BLAS_zdot_z_d_x.c && rm -f tmp.BLAS_zdot_z_d_x.c*
            # collect2: error: ld returned 1 exit status
            # failure.
            # removing: _configtest.c _configtest.o
        # Warning: prerequisite Chemistry::Mol 0.24 not found.
        #     collect2: error: ld returned 1 exit status
        #     Warning: prerequisite Chemistry::Mol 0.24 not found.
        #     Warning: prerequisite Statistics::Regression 0.15 not found.
        #     failure.
        #     removing: _configtest.c _configtest.o