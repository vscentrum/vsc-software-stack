easyblock = 'PythonBundle'

name = 'scArches'
version = '0.6.1'

homepage = 'https://github.com/theislab/scarches'
description = """Single-cell architecture surgery (scArches) is a package for reference-based analysis of single-cell
 data."""

toolchain = {'name': 'foss', 'version': '2023a'}

dependencies = [
    ('Python', '3.11.3'),
    ('SciPy-bundle', '2023.07'),
    ('Python-bundle-PyPI', '2023.06'),
    ('matplotlib', '3.7.2'),
    ('anndata', '0.10.5.post1'),
    ('h5py', '3.9.0'),
    ('leidenalg', '0.10.2'),
    ('scanpy', '1.9.8'),
    ('scikit-learn', '1.3.1'),
    ('scvi-tools', '1.1.2'),
    ('PyTorch', '2.1.2'),
    ('tqdm', '4.66.1'),
    ('IPython', '8.14.0'),
    ('pkgconfig', '1.5.5', '-python'),
    ('PyZMQ', '25.1.1'),
    ('tornado', '6.3.2'),
]

# ipykernel OK
# ipython<8.13.0 ??? EB only 8.14 for 12.3.0
# sphinx>=3.0.3 OK - pypi bundle
# nbconvert>=5.6.1 - ? maybe to exts
# nbsphinx>=0.7 - ? maybe to exts
# sphinx_rtd_theme - ? maybe to exts
# numpydoc OK
# cython OK - pypi bundle
# pkgconfig OK
# furo OK

# "scanpy>=1.6.0", OK
# "anndata>=0.7.4", OK
# "scHPL>=1.0.0", OK
# "h5py>=2.10.0", OK
# "torch>=1.8.0", OK
# "numpy>=1.19.2", OK
# "scipy>=1.5.2", OK
# "scikit-learn>=0.23.2", OK
# "matplotlib>=3.3.1", OK
# "pandas>=1.1.2", OK
# "scvi-tools>=0.12.1", OK
# "tqdm>=4.56.0", OK
# "requests", OK
# "gdown", OK
# "leidenalg", OK
# "muon", OK

# furo 2024.1.29 requires sphinx-basic-ng, ok exts
# ipykernel 6.29.3 requires comm, ok exts
# ipykernel 6.29.3 requires debugpy, ok exts
# schpl 1.0.5 has requirement newick~=1.0.0, but you have newick 1.9.0. -> sed out
# schpl 1.0.5 has requirement pandas<2,>=1.1.2, but you have pandas 2.0.3. -> sed out

use_pip = True

exts_list = [
    ('sphinx_basic_ng', '1.0.0b2', {
        'checksums': ['9ec55a47c90c8c002b5960c57492ec3021f5193cb26cebc2dc4ea226848651c9'],
    }),
    ('nodeenv', '1.9.0', {
        'checksums': ['07f144e90dae547bf0d4ee8da0ee42664a42a04e02ed68e06324348dafe4bdb1'],
    }),
    ('sphinx-theme-builder', '0.2.0b2', {
        'checksums': ['e9cd98c2bb35bf414fe721469a043cdcc10f0808d1ffcf606acb4a6282a6f288'],
    }),
    ('furo', '2024.1.29', {
        'checksums': ['4d6b2fe3f10a6e36eb9cc24c1e7beb38d7a23fc7b3c382867503b7fcac8a1e02'],
    }),
    ('numpydoc', '1.6.0', {
        'checksums': ['ae7a5380f0a06373c3afe16ccd15bd79bc6b07f2704cbc6f1e7ecc94b4f5fc0d'],
    }),
    ('jupyter_core', '5.7.2', {
        'checksums': ['aa5f8d32bbf6b431ac830496da7392035d6f61b4f54872f15c4bd2a9c3f536d9'],
    }),
    ('jupyter_client', '8.6.1', {
        'checksums': ['e842515e2bab8e19186d89fdfea7abd15e39dd581f94e399f00e2af5a1652d3f'],
    }),
    ('debugpy', '1.8.1', {
        'source_tmpl': '%(name)s-%(version)s-py2.py3-none-any.whl',
        'checksums': ['28acbe2241222b87e255260c76741e1fbf04fdc3b6d094fcf57b6c6f75ce1242'],
    }),
    ('comm', '0.2.2', {
        'checksums': ['3fd7a84065306e07bea1773df6eb8282de51ba82f77c72f9c85716ab11fe980e'],
    }),
    ('ipykernel', '6.29.3', {
        'checksums': ['e14c250d1f9ea3989490225cc1a542781b095a18a19447fcf2b5eaf7d0ac5bd2'],
    }),
    ('gdown', '5.1.0', {
        'checksums': ['550a72dc5ca2819fe4bcc15d80d05d7c98c0b90e57256254b77d0256b9df4683'],
    }),
    ('muon', '0.1.6', {
        'checksums': ['762feeb6f52f865cf79d0d0332cc742fe91c1885f668ce15794b62b3952b02f9'],
    }),
    ('newick', '1.9.0', {
        'checksums': ['9f81be96ec86aefca74d920fc0d6962d89a3156547003ca6915c2e6e31ad3ddf'],
    }),
    ('scHPL', '1.0.5', {
        'modulename': 'scHPL',
        # unpin pandas and newick versions to be compatible with foss/2023a versions
        'preinstallopts': "sed -i 's/~=/>=/g' setup.py && sed -i 's/pandas>=1.1.2,<2/pandas/g' setup.py && ",
        'checksums': ['3eb62b2e65b1faba04b7bcb86f7bf6967a6301866a605551211b8f14fd27eced'],
    }),
    (name, version, {
        'checksums': ['187463c25781d5c5586c129ad137d96327a9f8604d530a696d5f568a9225d77c'],
    }),
]

sanity_pip_check = True

# sanity_check_commands = ["python -c 'from pandas import DataFrame, concat, crosstab, read_csv'"]

moduleclass = 'bio'
