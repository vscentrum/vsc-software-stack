easyblock = 'Bundle'

name = 'PEcAn'
version = '1.7.2.9000'
versionsuffix = '-R-%(rver)s'

homepage = 'https://github.com/PecanProject/pecan'
description = """Ecosystem science, policy, and management informed by the best available data and models."""

toolchain = {'name': 'foss', 'version': '2023a'}

dependencies = [
    ('R', '4.3.2'),
    ('R-bundle-Bioconductor', '3.18', versionsuffix),
    ('PostgreSQL', '16.1'),
    ('CDO', '2.2.2'),
    ('HDF5', '1.14.0'),
    ('netCDF', '4.9.2'),
    ('UDUNITS', '2.2.28'),
    ('texlive', '20230313'),
    ('NCO', '5.1.9'),
    ('ncview', '2.1.8'),
    ('rjags', '4-15', versionsuffix),
    ('Redland', '1.0.17'),
]

exts_defaultclass = 'RPackage'
exts_default_options = {
    'sources': ['%(name)s_%(version)s.tar.gz'],
    'source_urls': [
        'https://cran.r-project.org/src/contrib/',  # current version of packages
        'https://cran.r-project.org/src/contrib/Archive/%(name)s',  # package archive
        'https://cran.freestatistics.org/src/contrib',  # mirror alternative for current packages
        'https://pecanproject.r-universe.dev/src/contrib/',  # PEcAn sources
    ],
}

local_sed_patterns_duckdb = '1146s/prefix_front_/prefix_front_back.prefix_front_/g;'
local_sed_patterns_duckdb += '1147s/prefix_back_/prefix_front_back.prefix_back_/g'

exts_list = [
    ('PEcAn.logger', '1.8.1.9000', {
        'checksums': ['3d1d8a6c9afa677dde8a4aaf72809932f0b6b5385ae4a6fc2059b48ed4b09195'],
    }),
    ('PEcAn.remote', '1.7.2', {
        'checksums': ['59feda08ac6784c5e607a70166e002df96385efbba3b77148b4cf9a0a1e2c9dc'],
    }),
    ('PEcAn.utils', '1.7.2', {
        'checksums': ['d83ae2a605f7867659d10de952f5db6b947dc3d2bc05633c0f72ced0b4caad17'],
    }),
    ('PEcAn.DB', version, {
        'checksums': ['f493d6ab100fce139bdb9747c91faff5cf60ff296ee16a82c6bc2366a9722231'],
    }),
    ('PEcAn.settings', '1.7.2', {
        'checksums': ['ab0dd41e9f421a84e68a16a1e4b290f70d852d23e66a2de1c3e91bf883aa1aeb'],
    }),
    ('PEcAn.MA', '1.7.2', {
        'checksums': ['bf3a5b6ac8adce4efb6be504cdeb10a71a59b3ac5af72c8d77b59a39c7d90ceb'],
    }),
    ('PEcAn.emulator', version, {
        'checksums': ['f4465a154e41cfe5a2cc94035ae4a5ddbfd3b5fc54a83bc9578c98a9eb07cff1'],
    }),
    ('PEcAn.priors', '1.7.2', {
        'checksums': ['001c26275ef23dda369fa2a5b408e481265d29137edeaebd03a30a39b4682edd'],
    }),
    ('PEcAn.uncertainty', version, {
        'checksums': ['a0d1a3a3d65e06b066d23473def763f5e158b2356ee5fe9e09020fe311e9ef4a'],
    }),
    ('amerifluxr', '1.0.0', {
        'checksums': ['ec54dce4b8e4108832eaadb60f7ef8ad28b459d3381316537492dcd755d83b25'],
    }),
    ('geonames', '0.999', {
        'checksums': ['1dd7bbd82d9425d14eb36f8e5bf431feaccfe3b0c4e70bf38f44f13dfc59e17b'],
    }),
    ('solartime', '0.0.2', {
        'checksums': ['5dd7a28db2bd4881ab740cd7004b88cd05c61e0954e3a10c8e18ebbe07d3e7d1'],
    }),
    ('bigleaf', '0.8.2', {
        'checksums': ['e41d82fb6298150c46f57128e959a1f1c6cfa55e916c32544bab7be69b0b6df7'],
    }),
    ('REddyProc', '1.3.3', {
        'checksums': ['3f673bd24f41813f631bf25139c9595bd91483e898ec31b7207c4eb8b7ff486b'],
    }),
    ('suntools', '1.0.0', {
        'checksums': ['42b7b39bd23ad48ded002150a0e7798fab94ed9828e5b5fdd8e5e1c9040697e2'],
    }),
    ('fauxpas', '0.5.2', {
        'checksums': ['84d07361a146b419cb1dcb7751654e3d5f159cf2704faf498e5ea56c8de61ef6'],
    }),
    ('nneo', '0.1.0', {
        'checksums': ['ca503e78cf4f4c85de6e18ad3ffde0c08d6a507ff5dc5ff91a50b3e04bf84a49'],
    }),
    ('PEcAn.data.atmosphere', '1.7.2', {
        'checksums': ['1847151588f669e91b35de637c804328efbc606141bf992bee650fd261b70e5a'],
    }),
    ('redland', '1.0.17-18', {
        'checksums': ['e999ba22321733df7ed056f528e38fc4be535d36bbac8106395c14f9f60a75a0'],
    }),
    ('datapack', '1.4.1', {
        'checksums': ['6149733ae90e6bbbb53d5f85ca29cec5f811825e794b56029b7f325de6637493'],
    }),
    ('dplR', '1.7.7', {
        'checksums': ['0e35a4d2a22773499f9e4592d1a198a08c9842388ce1e5a35394990ed4cdb2bd'],
    }),
    ('neonUtilities', '2.4.2', {
        'checksums': ['37b4efd0ed3b724de999d08d4d430954a6c717b1d943bc84c513c4fe8dbca057'],
    }),
    ('storr', '1.2.5', {
        'checksums': ['4224c3991d9c043a45ce530d0698d7f2cdca231b26fe31b45e0db865026e5f63'],
    }),
    ('thor', '1.1.5', {
        'checksums': ['99802d8c8471ce351403f8428c1efab48ccf20f359fbd368db84f25ef8f7ecae'],
    }),
    ('duckdb', '1.0.0-2', {
        'checksums': ['3735d51f22d62a7411aa514142cd569ce28bdaec4eb58d5f0893a476b9ccbf01'],
        # fixes the `prefix_back_ was not declared` error, see https://github.com/duckdb/duckdb/pull/12344
        'preinstallopts': "sed -i '%s' src/duckdb/third_party/re2/re2/prog.cc && " % local_sed_patterns_duckdb,
    }),
    ('duckdbfs', '0.0.4', {
        'checksums': ['90b2aff2bdefff1db4f855e2a9c9b19a404f522027105424aebd3c7e45944334'],
    }),
    ('neonstore', '0.5.1', {
        'checksums': ['f911e957861d558adead8ca77e4d1575a47dceb9553f1aa9d818460126deab9b'],
    }),
    ('HDInterval', '0.2.4', {
        'checksums': ['bb07f0edd660a02ed18e578c2798eb8c2db0e181a5e0c3e23db182d13e9494f6'],
    }),
    ('kknn', '1.3.1', {
        'checksums': ['22840e70ec2afa40371e274b583634c8f6d27149a87253ee411747d5db78f3db'],
    }),
    ('timeSeries', '4032.109', {
        'checksums': ['5e0c47584e0b01ea4011ed5ced217d95f8bb872611f6b029b0797d95eebd731f'],
    }),
    ('gss', '2.2-7', {
        'checksums': ['3b13144702c570c83462b4ea2ad17f4bd630cff5bf2ab0347a33c7e86a4f3f6a'],
    }),
    ('fBasics', '4032.96', {
        'checksums': ['e1556909871c836668b10bf90e1676aac6a2892a04663d7ab00c22a64c0b8690'],
    }),
    ('rmutil', '1.1.10', {
        'checksums': ['819fd7ce695cc742b4594705986eb06764460fc88521ea32de793c49de7ca5f9'],
    }),
    ('stable', '1.1.6', {
        'checksums': ['2238788a35b5aa9e175ad7b92348640c3dcad68b6ab0a0bc04aeec9084d29da4'],
    }),
    ('statip', '0.2.3', {
        'checksums': ['56a81a1882856cd1c5711ba133417b64f09071dda356e74280a0dba0db60d54f'],
    }),
    ('modeest', '2.4.0', {
        'checksums': ['1a949409bf64679d32400d20aa3d53e65a9a20f5bd1a40993b95f81100e0ed20'],
    }),
    ('runjags', '2.2.2-4', {
        'checksums': ['6f656e4d0620c0806e596ddb4bfec3934534ec17c02da699fcbfd6720a6f424f'],
    }),
    ('swfscMisc', '1.6.5', {
        'checksums': ['a49cb390643c4079f02986862eb2dfd33db4e6b6498e849bb418f73ffd6882e1'],
    }),
    ('CDM', '8.2-6', {
        'checksums': ['144a85e36c120e9f8a5bd35c1db50cf089ea4807721ac14460137b9a4b1c98d1'],
    }),
    ('TAM', '4.2-21', {
        'checksums': ['0d1782e42e89c1863edab12c1861d0e2628ea9ee1a1e37d268f27a3deaf3d568'],
    }),
    ('pbv', '0.5-47', {
        'checksums': ['e17a04efa96a601ab72172b59f555f36d28bb824f02f363cc5806b05d7d7c792'],
    }),
    ('sirt', '4.1-15', {
        'checksums': ['c12ffcb83bea5b549c7a34c12561f3e57798b83d68a887c5da0d9a66efac3066'],
    }),
    ('hoardr', '0.5.4', {
        'checksums': ['4e031ac1317584451c09bc8288ed73fb2d6ceea3c10d29dbb4be08157e489a37'],
    }),
    ('traits', '0.5.1', {
        'checksums': ['3080887a454d69814cd6cb9683a6750db02cf4c77b40b022ef50d40171ba6aca'],
    }),
    ('SimilarityMeasures', '1.4', {
        'checksums': ['b26bbc3a402d21f030cc8e4ff6baca644eb4c63a4fb33423dbc9436229a393f0'],
    }),
    ('PEcAn.benchmark', '1.7.2', {
        'checksums': ['c9cf9f299f810e4962476db1afdf6a39de77806fd82b6cb8bb7321e96c350db8'],
    }),
    ('PEcAn.visualization', '1.7.2', {
        'checksums': ['5d25871d57ded42c7ae7f8dbf0a6907c8b828f6a0463286e6ae178b356a4a848'],
    }),
    ('PEcAn.data.land', version, {
        'checksums': ['29ed015c1e8a5b993aebc31559aa3f7a4136b1f23e4c13a2d55118e7c541da2f'],
    }),
    ('MODISTools', '1.1.5', {
        'checksums': ['0a6b3762865424e299e1a5ec28de78b8dcca3f673e61f42a37dae19ed78db3e3'],
    }),
    ('PEcAn.data.remote', version, {
        'checksums': ['691b9e27cf5afb6bfb32873cca6ba284d0ff303873695e86f7653432aa7c66d4'],
    }),
    ('SparseGrid', '0.8.2', {
        'checksums': ['1d84ae83db2a390b111589a10570d55b378c2dd3310d3bc588a94ab8845cfd14'],
    }),
    ('lqmm', '1.5.8', {
        'checksums': ['11eddeeeed6b9d3190a80a3b3cc3d64519c6e9cb208746a3736139340df691fb'],
    }),
    ('PEcAn.workflow', '1.7.2', {
        'checksums': ['cdd60bf6a99b20aed9792b0cf6648c3f55f4b9bd3a00fd0187b7e7ec56815f0f'],
    }),
    ('PEcAn.assim.batch', version, {
        'checksums': ['d57b7ce1b0cbef0183bcb689f55f0345575289f1b8741c00cbd026eeaea8a6b9'],
    }),
    ('%(name)s.all', version, {
        'checksums': ['43e036ab8af9834ae6d7d7f4304adfc6cef08348e3be39ca5e51dcbb1fe21cce'],
    }),
]

sanity_check_paths = {
    'files': [],
    'dirs': ['%(name)s.all'],
}

modextrapaths = {'R_LIBS_SITE': ''}

moduleclass = 'math'
